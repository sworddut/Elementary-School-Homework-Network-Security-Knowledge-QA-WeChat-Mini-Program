# DC14 ---> DC10

## 训练

```R
library("readxl")
library("gam")

par(mfrow=c(2,2))
#定义检测异常值的函数
outlierDetection <- function(y) {
  mean_y <- mean(y)
  sd_y <- sd(y)
  outlier_threshold_upper <- mean_y + 3 * sd_y
  outlier_threshold_lower <- mean_y - 3 * sd_y
  index <- which(y > outlier_threshold_upper | y < outlier_threshold_lower) #找到超出阈值的值的下标
  result <- data.frame(index = index, value = y[index])
  return(result)
}

path <- "d:/学习/数模/1681372678943642/2023年mathorcup高校数学建模挑战赛赛题/c题/附件1：物流网络历史货量数据.xlsx"
data <- readxl::read_excel(path)
data.frm = data.frame(data)

# 求DC14--->DC10
DC1410 = data.frm[data.frm$场地1=='DC14' & data.frm$场地2=='DC10' & data.frm$货量>1000,]
DC1410.fit <- gam(货量 ~ s(日期,df=2) , data=DC1410)
plot(DC1410$日期,DC1410$货量)
lines(DC1410$日期,predict(DC1410.fit,newdata = data.frame(日期=DC1410$日期)),col="blue")
# 创建日期序列
date_seq <- seq(as.POSIXct("2023-01-01"),as.POSIXct("2023-01-31"), by = "day")
DC1410.predicted_values <- predict(DC1410.fit, newdata = data.frame(日期=date_seq))
lines(date_seq,DC1410.predicted_values,col="red")


#求DC20--->DC35
DC2035 = data.frm[data.frm$场地1=='DC20' & data.frm$场地2=='DC35',]
#去除离群点
DC2035 = DC2035[-outlierDetection(DC2035$货量)$index,]
DC2035.fit <- gam(货量 ~ s(日期,df=2) , data=DC2035)
plot(DC2035$日期,DC2035$货量)
lines(DC2035$日期,predict(DC2035.fit,newdata = data.frame(日期=DC2035$日期)),col="blue")
# 创建日期序列
date_seq <- seq(as.POSIXct("2023-01-01"),as.POSIXct("2023-01-31"), by = "day")
DC2035.predicted_values <- predict(DC2035.fit, newdata = data.frame(日期=date_seq))
lines(date_seq,DC2035.predicted_values,col="red")

#求DC25--->DC62
DC2562 = data.frm[data.frm$场地1=='DC25' & data.frm$场地2=='DC62',]
#去除离群点
DC2562 = DC2562[-outlierDetection(DC2562$货量)$index,]
DC2562.fit <- gam(货量 ~ s(日期,df=2) , data=DC2562)
plot(DC2562$日期,DC2562$货量)
lines(DC2562$日期,predict(DC2562.fit,newdata = data.frame(日期=DC2562$日期)),col="blue")
# 创建日期序列
date_seq <- seq(as.POSIXct("2023-01-01"),as.POSIXct("2023-01-31"), by = "day")
DC2562.predicted_values <- predict(DC2562.fit, newdata = data.frame(日期=date_seq))
lines(date_seq,DC2562.predicted_values,col="red")


```

![](D:\学习\数模\1681372678943642\2023年MathorCup高校数学建模挑战赛赛题\C题\DC14-DC10.jpg)

## 拟合

